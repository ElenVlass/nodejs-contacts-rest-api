##

Доблена логика аутентификации/авторизации пользователя с помощью
[JWT](https://jwt.io/).

##

В коде создана схему и модель пользователя для коллекции `users`.

Чтобы каждый пользователь работал и видел только свои контакты в схеме контактов
добавлено свойство `owner`.

### Регистрация

Создан эндпоинт `/users/signup`

Сделана валидация всех обязательных полей (`email` и `password`). При ошибке
валидации вернуть `Ошибку валидации`.

В случае успешной валидации в модели `User` создаутся пользователь по данным
которые прошли валидацию. Для засолки паролей использован
[bcrypt](https://www.npmjs.com/package/bcrypt) и
[bcryptjs](https://www.npmjs.com/package/bcryptjs)

- Если почта уже используется кем-то другим, возвращается `Ошибка Conflict`.
- В противном случае возвращается `Успешный ответ`.

### Логин

Создан эндпоинт `/users/login`

В модели `User` находится пользователя по `email`.

Сделана валидация всех обязательных полей (`email` и `password`). При ошибке
валидации везращается `Ошибка валидации`.

- В противном случае, сравнивается пароль для найденного юзера, если пароли
  совпадают создать токен, сохраняется в текущем юзере и возвращается
  `Успешный ответ`.
- Если пароль или email неверный, возвращается `Ошибку Unauthorized`.

### Проверка токена

Создан мидлвар для проверки токена и доблен ко всем маршрутам, которые должны
быть защищены.

- Мидлвар берет токен из заголовков `Authorization`, проверяет токен на
  валидность.
- В случае ошибки везвращается `Ошибка Unauthorized`.
- Если валидация прошла успешно, получ из токена `id` пользователя.
- Если пользователь существует и токен совпадает с тем, что находится в базе,
  записываются его данные в `req.user` и вызвается метод`next()`.
- Если пользователя с таким `id` не существует или токены не совпадают,
  возвращается `Ошибка Unauthorized`

### Логаут

Создан ендпоинт `/users/logout`

Добавлен в маршрут мидлвар проверки токена.

- В модели `User` находится пользователь по `_id`.
- Если пользователя не существует возвращается `Ошибка Unauthorized`.
- В противном случае, удалить токен в текущем юзере и вернуть `Успешный ответ`.

### Текущий пользователь - получение данные юзера по токену

Создан эндпоинт `/users/current`

Добавлен в маршрут мидлвар проверки токена.

- Если пользователя не существует возвращается `Ошибка Unauthorized`
- В противном случае возвращается `Успешный ответ`

- Сделана пагинацию с
  [mongoose-paginate-v2](https://www.npmjs.com/package/mongoose-paginate-v2) для
  коллекции контактов (GET /contacts?page=1&limit=20).
- Сделана фильтрацию контактов по полю избранного (GET /contacts?favorite=true)
- Обновление подписки (`subscription`) пользователя через эндпоинт `PATCH`
  `/users`. Подписка может иметь одно из следующих значений
  `['starter', 'pro', 'business']`
